name: Call Build and push to Azure Container Registry

#on: workflow_dispatch
on:
  push:
    branches:
      - 'building-and-testing-dotnet'

jobs:
  build_and_test:
    name: Build and test
    runs-on: ubuntu-latest
    steps:
    -
      run: "echo Would build"
    -
      run: "echo Would test"
      
  build_and_push_api:
    name: Build and push API
    permissions:
      id-token: write
      contents: read

    uses: ./.github/workflows/called.yml
  deploy-api:
    name: Deploy API
    needs: build_and_push_api
    runs-on: ubuntu-latest
    steps:
    -
      run: "echo Would deploy ${{ needs.build_and_push_api.outputs.PUBLISHED_DOCKER_IMAGE }}"
  # TODO - deploy-app
